enum restaurant_id_enum {
  anteatery
  brandywine
}

enum restaurant_name_enum {
  anteatery
  brandywine
}

table account {
  id text [pk, not null]
  accountId text [not null]
  providerId text [not null]
  userId text [not null]
  accessToken text
  refreshToken text
  idToken text
  accessTokenExpiresAt timestamp
  refreshTokenExpiresAt timestamp
  scope text
  password text
  createdAt timestamp [not null, default: `now()`]
  updatedAt timestamp [not null, default: `now()`]
}

table contributors {
  login text [pk, not null]
  avatar_url text [not null]
  contributions integer [not null]
  name text
  bio text [default: 'PeterPlate Contributor']
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
}

table diet_restrictions {
  dish_id text [pk, not null]
  contains_eggs boolean
  contains_fish boolean
  contains_milk boolean
  contains_peanuts boolean
  contains_sesame boolean
  contains_shellfish boolean
  contains_soy boolean
  contains_tree_nuts boolean
  contains_wheat boolean
  is_gluten_free boolean
  is_halal boolean
  is_kosher boolean
  is_locally_grown boolean
  is_organic boolean
  is_vegan boolean
  is_vegetarian boolean
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
}

table dishes {
  id text [pk, not null]
  station_id text [not null]
  name text [not null]
  description text [not null]
  ingredients text [default: 'Ingredient Statement Not Available']
  category text [not null, default: 'Other']
  num_ratings integer [not null, default: 0]
  total_rating integer [not null, default: 0]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp

  indexes {
    station_id [name: 'dishes_station_id_idx']
    name [name: 'dishes_name_idx']
    category [name: 'dishes_category_idx']
  }
}

table dishes_to_menus {
  menu_id text [not null]
  dish_id text [not null]

  indexes {
    (menu_id, dish_id) [pk]
  }
}

table events {
  title text [not null]
  image text
  restaurant_id restaurant_id_enum [not null]
  short_description text
  long_description text
  start timestamp
  end timestamp
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp

  indexes {
    (title, restaurant_id, start) [pk]
    restaurant_id [name: 'events_restaurant_id_idx']
  }
}

table favorites {
  user_id text [not null]
  dish_id text [not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp

  indexes {
    (user_id, dish_id) [pk]
  }
}

table logged_meals {
  user_id text [not null]
  dish_id text [not null]
  dish_name text [not null]
  servings real [not null, default: 1]
  eaten_at timestamp [not null, default: `now()`]

  indexes {
    (user_id, dish_id) [pk]
    
  }
}

table menus {
  id text [pk, not null]
  period_id text [not null]
  date date [not null]
  restaurant_id restaurant_id_enum [not null]
  price "numeric(6, 2)"
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp

  indexes {
    (restaurant_id, date) [name: 'menus_restaurant_date_idx']
    restaurant_id [name: 'menus_restaurant_id_idx']
    date [name: 'menus_date_idx']
    period_id [name: 'menus_period_id_idx']
    
    
  }
}

table nutrition_infos {
  dish_id text [pk, not null]
  serving_size text
  serving_unit text
  calories "numeric(10, 2)"
  total_fat_g "numeric(10, 2)"
  trans_fat_g "numeric(10, 2)"
  saturated_fat_g "numeric(10, 2)"
  cholesterol_mg "numeric(10, 2)"
  sodium_mg "numeric(10, 2)"
  total_carbs_g "numeric(10, 2)"
  dietary_fiber_g "numeric(10, 2)"
  sugars_g "numeric(10, 2)"
  protein_g "numeric(10, 2)"
  calcium "numeric(10, 2)"
  iron "numeric(10, 2)"
  vitamin_a "numeric(10, 2)"
  vitamin_c "numeric(10, 2)"
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
}

table periods {
  id text [not null]
  date date [not null]
  restaurant_id restaurant_id_enum [not null]
  start time [not null]
  end time [not null]
  name text [not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp

  indexes {
    (id, date, restaurant_id) [pk]
    (restaurant_id, date) [name: 'periods_restaurant_date_idx']
  }
}

table push_tokens {
  token text [pk, not null]
}

table ratings {
  user_id text [not null]
  dish_id text [not null]
  rating real [not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp

  indexes {
    (user_id, dish_id) [pk]
  }
}

table restaurants {
  id restaurant_id_enum [pk, not null]
  name restaurant_name_enum [not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
}

table session {
  id text [pk, not null]
  expiresAt timestamp [not null]
  token text [not null, unique]
  createdAt timestamp [not null, default: `now()`]
  updatedAt timestamp [not null, default: `now()`]
  ipAddress text
  userAgent text
  userId text [not null]
}

table stations {
  id text [pk, not null]
  name text [not null]
  restaurant_id restaurant_id_enum [not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp

  indexes {
    restaurant_id [name: 'stations_restaurant_id_idx']
  }
}

table users {
  id text [pk, not null]
  name text [not null]
  email text [not null, unique]
  emailVerified boolean [not null, default: false]
  image text
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
}

table verification {
  id text [pk, not null]
  identifier text [not null]
  value text [not null]
  expiresAt timestamp [not null]
  createdAt timestamp [default: `now()`]
  updatedAt timestamp [default: `now()`]
}

ref: dishes.station_id > stations.id

ref: dishes.id - diet_restrictions.dish_id

ref: dishes.id - nutrition_infos.dish_id

ref: dishes_to_menus.dish_id > dishes.id

ref: dishes_to_menus.menu_id > menus.id

ref: events.restaurant_id > restaurants.id

ref: favorites.dish_id - dishes.id

ref: favorites.user_id > users.id

ref: menus.restaurant_id > restaurants.id

ref: menus.(period_id, date) - periods.(id, date)

ref: ratings.dish_id - dishes.id

ref: ratings.user_id > users.id

ref: stations.restaurant_id > restaurants.id